import React, { useState, useEffect } from 'react';
import { ChevronRight, ChevronLeft, Heart, BookOpen, MessageCircle, Star, PenTool, CheckCircle, RefreshCcw, HelpCircle, Award, Share2 } from 'lucide-react';

const DevocionalApp = () => {
  const [currentStep, setCurrentStep] = useState(0);
  const [completed, setCompleted] = useState(false);
  const [quizAnswer, setQuizAnswer] = useState(null);
  const [showFeedback, setShowFeedback] = useState(false);

  // URL de la marca proporcionada por el usuario
  const brandLogo = "https://i.imgur.com/dDYOrEm.png";

  // Componente para mostrar el logo en lugar de los iconos de Lucide
  const BrandIcon = ({ className = "h-5 w-auto" }) => (
    <img 
      src={brandLogo} 
      alt="Logo" 
      className={`${className} object-contain`} 
    />
  );

  const steps = [
    {
      title: "Bienvenida",
      subtitle: "Portada del Devocional",
      isCover: true,
      content: (
        <div className="space-y-6 text-center animate-in fade-in duration-1000">
          <div className="relative w-full rounded-3xl overflow-hidden shadow-2xl bg-slate-900 aspect-[4/5] md:aspect-video mb-6">
            <img 
              src="https://i.imgur.com/yrP3u2O.png" 
              alt="Portada: Cuando el Cielo Ordena tus Letras" 
              className="w-full h-full object-cover"
            />
            {/* Overlay para legibilidad */}
            <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-black/40" />
            
            {/* Logo de marca en la portada */}
            <div className="absolute top-6 left-6">
              <img 
                src={brandLogo} 
                alt="Logo Marca" 
                className="h-10 w-auto object-contain brightness-0 invert opacity-90" 
              />
            </div>

            <div className="absolute bottom-8 left-0 right-0 px-8 text-left">
              <span className="bg-indigo-600 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-[0.2em] mb-3 inline-block shadow-lg">
                Plan Familiar Dominical
              </span>
              <h1 className="text-4xl md:text-5xl font-black text-white leading-[1.1] tracking-tight drop-shadow-2xl">
                Cuando el Cielo <br />
                <span className="text-indigo-400">Ordena tus Letras</span>
              </h1>
            </div>
          </div>
          
          <div className="px-4 space-y-4">
            <p className="text-gray-500 font-medium italic text-lg leading-relaxed">
              "Un tiempo para reconocer que Dios escucha incluso nuestros pensamientos m√°s sencillos."
            </p>
            <div className="flex justify-center gap-1.5 text-amber-400">
              <Star size={18} fill="currentColor" />
              <Star size={18} fill="currentColor" />
              <Star size={18} fill="currentColor" />
              <Star size={18} fill="currentColor" />
              <Star size={18} fill="currentColor" />
            </div>
          </div>
        </div>
      )
    },
    {
      title: "Introducci√≥n",
      subtitle: "La amnesia y la an√©cdota",
      content: (
        <div className="space-y-4">
          {/* Video / GIF Section */}
          <div className="relative w-full rounded-2xl overflow-hidden shadow-md bg-slate-100 mb-6 border border-gray-100">
            <video 
              src="https://i.imgur.com/bW3e1SV.mp4" 
              autoPlay 
              loop 
              muted 
              playsInline
              className="w-full h-auto object-cover max-h-[300px]"
            />
            <div className="absolute bottom-2 right-2 bg-black/30 backdrop-blur-sm px-2 py-1 rounded text-[10px] text-white/80">
              Reflexi√≥n visual
            </div>
          </div>

          <p className="text-gray-700 leading-relaxed">
            Hola a todos. ¬øSaben? Estaba pensando en lo fr√°giles que somos con nuestra memoria. A veces le pedimos milagros a Dios, pero apenas lo tenemos, nos da una especie de <strong>"amnesia espiritual"</strong>.
          </p>
          <div className="bg-blue-50 p-4 rounded-xl border-l-4 border-blue-500 italic text-blue-900">
            "Olvidamos r√°pido. Pero hoy quiero contarles algo que me pas√≥ y que me niego a olvidar."
          </div>
          <p className="text-gray-700">
            ¬øSe acuerdan de la pasada Navidad? Compramos ropa, zapatos y ¬°un bal√≥n de f√∫tbol! Uno da el regalo y piensa: "Misi√≥n cumplida".
          </p>
          <div className="bg-amber-50 p-6 rounded-2xl shadow-sm border border-amber-100">
            <h4 className="font-bold text-amber-800 mb-2 flex items-center gap-2">
              <BookOpen size={18} /> Proverbios 4:23
            </h4>
            <p className="text-lg text-amber-900 font-serif italic">
              "Sobre toda cosa guardada, guarda tu coraz√≥n; porque de √©l mana la vida."
            </p>
          </div>
        </div>
      )
    },
    {
      title: "Punto 1",
      subtitle: "La intenci√≥n detr√°s de la acci√≥n",
      content: (
        <div className="space-y-4">
          <p className="text-gray-700">
            ¬øPor qu√© hacemos lo que hacemos? A veces nos complicamos pensando si "hicimos suficiente". Pero miren lo que dice el ap√≥stol Pablo:
          </p>
          <div className="bg-indigo-600 p-6 rounded-2xl text-white shadow-lg">
            <h4 className="font-bold mb-2 flex items-center gap-2">
              <BrandIcon className="h-4 brightness-0 invert" /> 1 Corintios 10:31
            </h4>
            <p className="text-xl font-medium">
              "Si, pues, com√©is o beb√©is, o hac√©is otra cosa, hacedlo todo para la gloria de Dios."
            </p>
          </div>
          <div className="bg-gray-50 p-4 rounded-xl border border-gray-200">
            <h5 className="font-bold text-gray-800 mb-2">Pregunta para la familia:</h5>
            <p className="text-gray-600 italic">¬øEn qu√© √°reas de tu rutina diaria te cuesta m√°s recordar que lo haces para la gloria de Dios?</p>
          </div>
          <p className="text-gray-700 font-semibold text-center mt-4">
            ¬øTu coraz√≥n estaba alineado con el Cielo al darlo?
          </p>
        </div>
      )
    },
    {
      title: "Ilustraci√≥n Central",
      subtitle: "La ni√±a y el alfabeto",
      content: (
        <div className="space-y-4">
          <p className="text-gray-700 italic">
            "Una ni√±a le dijo a sus padres que ir√≠a a orar. Al escuchar tras la puerta, la oyeron repetir el abecedario. Al preguntarle, ella respondi√≥:"
          </p>
          <div className="bg-emerald-50 p-6 rounded-2xl border-2 border-dashed border-emerald-200 text-emerald-900 font-medium text-lg text-center">
            "¬°Ay, pap√°s! Lo que pasa es que yo tengo tanta fe, que s√© que yo ac√° digo las letras y all√° en el cielo Dios arma las palabras."
          </div>
          <p className="text-gray-600 text-sm text-center">
            Esta representaci√≥n nos recuerda que Dios toma nuestro caos y lo vuelve un mensaje claro de amor.
          </p>
        </div>
      )
    },
    {
      title: "Punto 2",
      subtitle: "Dios transforma desde adentro",
      content: (
        <div className="space-y-4">
          <p className="text-gray-700">
            Dios no busca el discurso perfecto, busca transformaci√≥n interna.
          </p>
          <div className="bg-white p-6 rounded-2xl border-2 border-purple-100 shadow-sm">
            <h4 className="font-bold text-purple-800 mb-2 flex items-center gap-2">
              <RefreshCcw size={18} /> Romanos 12:2
            </h4>
            <p className="text-gray-800 leading-relaxed">
              "No se amolden al mundo actual, sino sean <strong>transformados mediante la renovaci√≥n de su mente</strong>."
            </p>
          </div>
          <div className="flex items-center gap-4 bg-purple-50 p-4 rounded-xl">
            <div className="text-3xl">ü¶ã</div>
            <p className="text-sm text-purple-900 italic">
              La transformaci√≥n es de adentro hacia afuera. La ni√±a dio sus letras y dej√≥ que Dios hiciera la obra.
            </p>
          </div>
        </div>
      )
    },
    {
      title: "Test de Fe",
      subtitle: "¬øQu√© aprendimos hoy?",
      content: (
        <div className="space-y-6">
          <div className="bg-slate-50 p-6 rounded-2xl border border-slate-200">
            <h4 className="font-bold text-slate-800 text-lg mb-4 flex items-center gap-2">
              <HelpCircle className="text-indigo-500" size={20} />
              ¬øQu√© buscaba ense√±arnos la ni√±a al repetir el abecedario?
            </h4>
            
            <div className="space-y-3">
              {[
                { id: 'a', text: "Que no sab√≠a orar correctamente.", correct: false },
                { id: 'b', text: "Que Dios conoce nuestra intenci√≥n y √âl ordena nuestra oraci√≥n.", correct: true },
                { id: 'c', text: "Que Dios prefiere el orden alfab√©tico.", correct: false }
              ].map((opt) => (
                <button
                  key={opt.id}
                  onClick={() => { setQuizAnswer(opt.id); setShowFeedback(true); }}
                  className={`w-full p-4 rounded-xl text-left font-medium transition-all border-2 flex items-center justify-between ${
                    quizAnswer === opt.id 
                      ? (opt.correct ? 'border-emerald-500 bg-emerald-50 text-emerald-900' : 'border-rose-500 bg-rose-50 text-rose-900')
                      : 'border-white bg-white hover:border-indigo-100 shadow-sm'
                  }`}
                >
                  <span>{opt.text}</span>
                  {quizAnswer === opt.id && (opt.correct ? <CheckCircle size={18} /> : <span>‚úï</span>)}
                </button>
              ))}
            </div>
          </div>

          {showFeedback && (
            <div className={`p-4 rounded-xl animate-in zoom-in-95 duration-300 flex items-start gap-3 ${
              quizAnswer === 'b' ? 'bg-emerald-100 text-emerald-800' : 'bg-rose-100 text-rose-800'
            }`}>
              <div className="mt-1">{quizAnswer === 'b' ? <Award size={20} /> : <HelpCircle size={20} />}</div>
              <p className="text-sm">
                {quizAnswer === 'b' 
                  ? "¬°Correcto! Dios no busca elocuencia, sino un coraz√≥n que conf√≠a en Su soberan√≠a." 
                  : "Casi... Recuerda que la fe de la ni√±a consist√≠a en confiar que Dios 'armaba' sus letras."}
              </p>
            </div>
          )}
        </div>
      )
    },
    {
      title: "Cierre",
      subtitle: "Bendice alma m√≠a",
      content: (
        <div className="space-y-6">
          <div className="bg-slate-800 p-8 rounded-3xl text-white text-center shadow-xl">
            <h4 className="text-slate-400 text-sm uppercase tracking-widest mb-2 font-bold">Salmos 103:2</h4>
            <p className="text-2xl font-serif italic mb-4">
              "Bendice, alma m√≠a, a Jehov√°, Y no olvides ninguno de sus beneficios."
            </p>
          </div>
          
          <div className="bg-amber-50 p-6 rounded-2xl border border-amber-200">
            <h4 className="font-bold text-amber-900 mb-3 flex items-center gap-2">
              <PenTool size={18} /> Oraci√≥n Final
            </h4>
            <p className="text-amber-800 italic leading-relaxed">
              "Se√±or, hoy te entregamos nuestras letras, nuestro 'A, B, C', confiando en que T√∫ all√° en el cielo armas las oraciones y cumples Tu prop√≥sito. Am√©n."
            </p>
          </div>

          <button 
            onClick={() => setCompleted(true)}
            className="w-full py-4 bg-emerald-600 text-white font-bold rounded-2xl hover:bg-emerald-700 transition-colors shadow-lg flex items-center justify-center gap-2"
          >
            <CheckCircle size={20} /> ¬°He terminado mi devocional!
          </button>
        </div>
      )
    }
  ];

  const progress = ((currentStep + 1) / steps.length) * 100;

  if (completed) {
    return (
      <div className="min-h-screen bg-slate-50 flex items-center justify-center p-6 font-sans text-slate-800">
        <div className="max-w-md w-full bg-white rounded-3xl shadow-2xl p-10 text-center space-y-6 border border-gray-100">
          <div className="w-24 h-24 bg-indigo-50 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse border-4 border-white shadow-xl">
            <BrandIcon className="h-12 w-auto" />
          </div>
          <h1 className="text-3xl font-extrabold text-gray-900">¬°Gloria a Dios!</h1>
          <p className="text-gray-600 text-lg">Has completado el devocional de hoy. Que estas verdades guarden tu coraz√≥n.</p>
          <button 
            onClick={() => {setCurrentStep(0); setCompleted(false); setQuizAnswer(null); setShowFeedback(false);}}
            className="px-8 py-3 bg-gray-900 text-white rounded-full font-bold hover:bg-gray-800 transition-all shadow-lg"
          >
            Volver a empezar
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-slate-50 flex flex-col font-sans text-slate-800">
      {/* Header */}
      {!steps[currentStep].isCover && (
        <header className="bg-white border-b border-gray-100 px-6 py-4 sticky top-0 z-10 shadow-sm">
          <div className="max-w-2xl mx-auto flex items-center justify-between">
            <div className="flex items-center gap-3">
              <img src={brandLogo} alt="Logo" className="h-8 w-auto object-contain" />
              <div className="h-6 w-px bg-gray-200 mx-1 hidden sm:block"></div>
              <div>
                <h1 className="text-[10px] font-black text-indigo-500 uppercase tracking-widest">Devocional Familiar</h1>
                <p className="text-sm font-bold text-slate-800 truncate max-w-[150px] sm:max-w-none">{steps[currentStep].title}</p>
              </div>
            </div>
            {/* C√≠rculo con la MARCA */}
            <div className="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-md border border-gray-50 overflow-hidden p-1.5 transition-transform hover:scale-110">
              <BrandIcon className="h-full w-auto" />
            </div>
          </div>
          <div className="max-w-2xl mx-auto mt-4 h-1 w-full bg-gray-100 rounded-full overflow-hidden">
            <div className="h-full bg-indigo-500 transition-all duration-500 ease-out" style={{ width: `${progress}%` }} />
          </div>
        </header>
      )}

      {/* Main Content */}
      <main className="flex-1 overflow-y-auto px-6 py-8">
        <div className={`max-w-2xl mx-auto bg-white rounded-3xl shadow-sm border border-gray-100 p-6 md:p-10 min-h-[500px] flex flex-col ${steps[currentStep].isCover ? 'justify-center' : ''}`}>
          {!steps[currentStep].isCover && (
            <div className="mb-8">
              <span className="text-indigo-500 font-bold text-sm uppercase tracking-widest">Secci√≥n {currentStep}</span>
              <h2 className="text-3xl font-black text-gray-900 mt-1">{steps[currentStep].subtitle}</h2>
            </div>
          )}
          
          <div className="flex-1 animate-in fade-in slide-in-from-bottom-4 duration-700">
            {steps[currentStep].content}
          </div>
        </div>
      </main>

      {/* Footer Navigation */}
      <footer className="bg-white border-t border-gray-100 p-6">
        <div className="max-w-2xl mx-auto flex gap-4">
          {currentStep > 0 && (
            <button 
              onClick={() => { setCurrentStep(prev => prev - 1); setQuizAnswer(null); setShowFeedback(false); }}
              className="flex-1 py-4 bg-gray-100 text-gray-600 rounded-2xl font-bold flex items-center justify-center gap-2 hover:bg-gray-200"
            >
              <ChevronLeft size={20} /> Anterior
            </button>
          )}
          
          {currentStep < steps.length - 1 && (
            <button 
              onClick={() => { setCurrentStep(prev => prev + 1); setQuizAnswer(null); setShowFeedback(false); window.scrollTo(0, 0); }}
              className="flex-[2] py-4 bg-indigo-600 text-white rounded-2xl font-bold flex items-center justify-center gap-2 hover:bg-indigo-700 shadow-lg transition-transform active:scale-95"
            >
              {currentStep === 0 ? 'Empezar Devocional' : 'Siguiente'} <ChevronRight size={20} />
            </button>
          )}
        </div>
      </footer>
    </div>
  );
};

export default function App() {
  return <DevocionalApp />;
}